{% extends 'base.html.twig' %}

{% block title %}Admin{% endblock %}

{% block javascripts %}
	{{ encore_entry_script_tags('pdf-editor') }}
{% endblock %}

{% block body %}
	<h1 class="text-2xl font-bold mb-4">Paramétrage du livrable : {{ typeLivrable.nom }}</h1>

	<div class="grid grid-cols-5 gap-4">
		<!-- Partie gauche : PDF + sélection -->
		<div id="pdf-editor"
			 class="col-span-2 relative"
			 data-controller="pdf-editor"
			 data-pdf-editor-url-value="{{ asset('uploads/pdf/' ~ typeLivrable.path) }}">

			<canvas id="pdf-editor-canvas"
					data-pdf-editor-target="canvas"
					class="w-full h-full block"
					style="cursor: default;">
			</canvas>

			<div class="flex justify-center mt-2">
				<div class="join">
					<button id="prevPage"
							class="join-item btn"
							data-action="pdf-editor#prevPage">
						<i class="fa-solid fa-chevron-left"></i>
					</button>

					<span id="pageInfo"
						  class="join-item btn"
						  data-pdf-editor-target="pageInfo">
                        Page 1
                    </span>

					<button id="nextPage"
							class="join-item btn"
							data-action="pdf-editor#nextPage">
						<i class="fa-solid fa-chevron-right"></i>
					</button>
				</div>
			</div>

		</div>

		<!-- Partie droite : configuration -->
		<div class="col-span-3">
			<div class="flex justify-between items-center mb-2">
				<h2 class="text-lg font-semibold">Zones</h2>
				<button id="addZoneBtn" class="btn btn-sm btn-primary">Ajouter une zone</button>
			</div>
			<div id="zone-list">
				{% for zone in typeLivrable.zones %}
					<div class="border p-2 mb-4 rounded bg-base-100 shadow">
						<h3 class="font-bold">{{ zone.libelle }}</h3>
						<p class="text-xs">Page : {{ zone.page }}</p>
						<button data-zone-id="{{ zone.id }}" class="btn btn-sm btn-secondary mt-2 add-champ-btn">
							Ajouter un champ
						</button>
						<div class="mt-2">
							{% for champ in zone.champs %}
								<div class="text-sm p-1 border-b">
									{{ champ.typeChamps.nom }} : {{ champ.question }}
								</div>
							{% endfor %}
						</div>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>

{% endblock %}